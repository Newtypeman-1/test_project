<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원 내 문의/리뷰 기록</title>
<style>
	.page-title{
		text-align: center;
		padding: 30px;
		font-size: 25px;
	}
	.page-menu{
		width: 1500px;
		margin: 0 auto;
		display: flex;
		justify-content: flex-end;
		align-items: center;
		flex-wrap: wrap;
	}
	.info{
		margin-bottom: 40px;
		border: 1px solid black;
		border-radius: 15px;
		padding: 10px;
		align-items: center;
		width: 1200px;
	}
	.page-menu>.info:last-child{
		float: right;
	}
	.tbl{
		width: 100%;
		margin: 0 auto;
		text-align: center;
	}
	.tbl tr:first-child{
		border-bottom: 1px solid black;	
	}
	.star {
        color: gold;
        font-size: 24px;
    }
    .qwer{
    	margin-top: 5px;
    	margin-bottom: 5px;
    	box-sizing: border-box;
    }
</style>
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<main class="main">
		<th:block th:include="common/menuRemote"></th:block>
		<section class="section">
			<div class="page-title">내 문의/리뷰 기록</div>
			<div class="page-menu">
				<div class="info quest-page">
					<table class="tbl">
						<tr>
							<th style="width:10%">문의번호</th>
							<th style="width:40%">제목</th>
							<th style="width:15%">답변</th>
							<th style="width:10%">작성일</th>
						</tr>
						<tr th:each="board : ${boardList}" class="qwer">
							<td th:text="${board.boardNo}"></td>
							<td th:text="${board.boardTitle}"></td>
							<td>답변</td>
							<td th:text="${board.boardRegDate}"></td>
						</tr>	
					</table>
						<button type="button" class="allQna">전체 문의 보기</button>
				</div>
				<div class="info review-page">
					<table class="tbl">
						<tr>
							<th style="width:10%">리뷰번호</th>
							<th style="width:40%">내용</th>
							<th style="width:15%">별점</th>
							<th style="width:10%">작성일</th>
						</tr>
						<tr th:each="review : ${reviewList}" class="qwer">
								<td th:text="${review.reviewNo}"></td>
								<td th:text="${review.reviewContent}"></td>
								<td class="star-cell" th:attr="data-star=${review.reviewStar}"></td>
								<td th:text="${review.reviewDate}"></td>
						</tr>
					</table>
						<button type="button" class="allReview">전체 리뷰 보기</button>						
				</div>
			</div>
		</section>
	</main>
	<th:block th:include="common/footer"></th:block>
	<script>       
		$(".star-cell").each(function () {
		    let starCount = parseInt($(this).attr("data-star")) || 0;
		    let stars = "";
		    for (let i = 0; i < 5; i++) {
		        if (i < starCount) {
		            stars += '<span class="material-icons star">star_rate</span>'; // Filled star
		        } else {
		            stars += '<span class="material-icons star" style="color: lightgray;">star_rate</span>'; // Empty star
		        }
		    }
		    $(this).html(`<div class="star-wrap">${stars}</div>`);
		});   
		$(".allReview").on("click", function(){
			swal({
				title : "확인",
					text : "리뷰 전체 보시겠습니까?",
					icon : "success",
					buttons : {
						confirm : {
						text : "확인",
							value : true,
							visible : true,
							closeModal : true
						},
						cancle : {
							text : "취소",
							value : false,
							visible : true,
							closeModal : true
						}
					}
				}).then(function(isConfirm){
					if(isConfirm){
						location.href = "/review/list?reqPage=1";
					}
				});
		});
		$(".allQna").on("click", function(){
			swal({
				title : "확인",
					text : "문의 전체 보시겠습니까?",
					icon : "success",
					buttons : {
						confirm : {
						text : "확인",
							value : true,
							visible : true,
							closeModal : true
						},
						canc : {
							text : "취소",
							value : false,
							visible : true,
							closeModal : true
						}
					}
				}).then(function(isConfirm){
					if(isConfirm){
						location.href = "/member/myMedicalRecordsPageFrm?reqPage=1";
					}
				});
		});
	</script>
</body>
</html>